{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport { loginUser, loginUserFacebook } from '../../redux/actions/authActions';\nimport TextFieldGroup from '../common/TextFieldGroup';\nimport Separator from '../common/Separator';\nimport { isEmpty } from '../../utils/Util';\n\nvar Login =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Login, _Component);\n\n  function Login() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Login)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      email: '',\n      password: '',\n      errors: {}\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChange\", function (e) {\n      _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmit\", function (e) {\n      e.preventDefault();\n      var user = {\n        username: _this.state.email,\n        password: _this.state.password\n      };\n\n      var res = _this.props.loginUser(user);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"facebookLogin\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              // const res = await this.props.loginUserFacebook();\n              // console.log('From Client:');\n              // console.log(res);\n              Router.push('/api/auth/facebook');\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      if (!this.props.auth.isAuthenticated && nextProps.auth.isAuthenticated) {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.isAuthenticated) {\n        Router.push('/dashboard');\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(newProps) {\n      if (newProps.auth.isAuthenticated) {\n        Router.push('/dashboard');\n      }\n\n      if (newProps.auth.errors) {\n        this.setState({\n          errors: newProps.auth.errors\n        });\n      }\n    }\n  }, {\n    key: \"renderAlreadyLoggedIn\",\n    value: function renderAlreadyLoggedIn() {\n      return React.createElement(\"div\", null, React.createElement(\"h2\", {\n        className: \"display-4 text-center mb-5\"\n      }, \"You're already logged in\"), React.createElement(\"p\", null, \"Were you looking for the\", React.createElement(Link, {\n        href: \"/logout\"\n      }, React.createElement(\"a\", null, \"Dashboard?\"))));\n    }\n  }, {\n    key: \"renderLoginForm\",\n    value: function renderLoginForm() {\n      var errors = this.state.errors;\n      return React.createElement(\"div\", null, React.createElement(\"h1\", {\n        className: \"display-4 text-center mb-5\"\n      }, \"Login to your account\"), React.createElement(\"form\", {\n        noValidate: true,\n        onSubmit: this.onSubmit\n      }, React.createElement(TextFieldGroup, {\n        name: \"email\",\n        placeholder: \"Email Address\",\n        type: \"email\",\n        value: this.state.email,\n        onChange: this.onChange,\n        error: errors.email\n      }), React.createElement(TextFieldGroup, {\n        name: \"password\",\n        placeholder: \"Password\",\n        type: \"password\",\n        value: this.state.password,\n        onChange: this.onChange,\n        error: errors.password\n      }), React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"btn btn-warning btn-block mt-4 mb-4 border border-dark\",\n        value: \"Log in\"\n      })), isEmpty(this.state.errors) ? '' : React.createElement(\"div\", {\n        className: \"text-center\"\n      }, React.createElement(Link, {\n        href: \"/password/reset\"\n      }, React.createElement(\"a\", null, \"Forgot your password?\"))), React.createElement(\"div\", {\n        className: \"text-center\"\n      }, React.createElement(Separator, {\n        color: \"dark-gray\",\n        marginTop: \"4\",\n        marginBottom: \"2\",\n        length: \"12\"\n      }), React.createElement(\"p\", null, \"Or login with:\"), React.createElement(Link, {\n        href: \"/api/auth/facebook\"\n      }, React.createElement(\"button\", {\n        className: \"border-0 mx-2\"\n      }, React.createElement(\"i\", {\n        className: \"fab fa-facebook-square fa-4x text-primary\"\n      }))), React.createElement(Link, {\n        href: \"/api/auth/steam\"\n      }, React.createElement(\"button\", {\n        className: \"border-0 mx-2 p-0\"\n      }, React.createElement(\"i\", {\n        className: \"fab fa-steam-square fa-4x text-dark\"\n      })))));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var isAuthenticated = this.props.auth.isAuthenticated;\n      return React.createElement(\"div\", {\n        className: \"login mt-3 full-height\"\n      }, React.createElement(\"div\", {\n        className: \"container\"\n      }, React.createElement(\"div\", {\n        className: \"row\"\n      }, React.createElement(\"div\", {\n        className: \"col-10 col-md-8 col-lg-6 m-auto\"\n      }, isAuthenticated ? this.renderAlreadyLoggedIn() : this.renderLoginForm()))));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    auth: state.auth\n  };\n};\n\nexport default connect(mapStateToProps, {\n  loginUser: loginUser,\n  loginUserFacebook: loginUserFacebook\n})(Login); // export default connect(mapStateToProps)(Login);","map":null,"metadata":{},"sourceType":"module"}